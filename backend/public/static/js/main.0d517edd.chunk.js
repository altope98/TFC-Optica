(this["webpackJsonpreact-optica"]=this["webpackJsonpreact-optica"]||[]).push([[0],{105:function(e,t,a){e.exports=a(172)},113:function(e,t,a){},114:function(e,t,a){},172:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(14),l=a.n(s),i=(a(110),a(111),a(113),a(114),a(10)),o=a(11),c=a(12),m=a(13),u=a(15),d=a(37),p=a(82),h=a.n(p),f=a(46),g=a.n(f);a(115),a(116),a(118);g.a.initializeApp({apiKey:"AIzaSyCpodxaWgqwls4795dWt3ZbqGEm9Ltt6fY",authDomain:"proyecto-consulta-firebase.firebaseapp.com",databaseURL:"https://proyecto-consulta-firebase.firebaseio.com",projectId:"proyecto-consulta-firebase",storageBucket:"proyecto-consulta-firebase.appspot.com",messagingSenderId:"1072801915077",appId:"1:1072801915077:web:3ea752b2a8a7839bb150ac"});var E=g.a.auth(),v=(g.a.firestore(),g.a.storage()),b=a(5),N=a.n(b),y={url:"https://tope-vision.herokuapp.com/"},x=function(e){Object(m.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).url=y.url,e.state={identity:!1,user:{},userId:null,redirect:!1},e.logout=function(){E.signOut().then((function(){e.setState({identity:!1,user:{},userId:null,redirect:!0}),N.a.post(e.url+"carrito/cerrar")})).catch((function(e){alert(e.message)}))},e}return Object(o.a)(a,[{key:"componentDidUpdate",value:function(){var e=this;if(!0===this.props.logged&&null!=E.currentUser&&!1===this.state.identity){var t=E.currentUser.email;N.a.get(this.url+"user/"+t).then((function(t){"success"===t.data.status?e.setState({identity:!0,user:t.data.user,userId:t.data.userId,redirect:!1}):e.setState({identity:null})}))}!1===this.state.identity&&N.a.post(this.url+"carrito/cerrar")}},{key:"render",value:function(){return n.a.createElement(n.a.Fragment,null,!0===this.state.redirect&&n.a.createElement(d.a,{to:"/signout"}),n.a.createElement("header",{id:"header",className:"container-fluid"},n.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light",id:"barra"},n.a.createElement("div",{className:"navbar-brand"},n.a.createElement(u.c,{to:"/",activeClassName:"active"},n.a.createElement("img",{src:h.a,className:"app-logo",id:"logo",alt:"Logotipo"}))),n.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},n.a.createElement("span",{className:"navbar-toggler-icon"})),n.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent"},n.a.createElement("ul",{className:"navbar-nav mr-auto"},n.a.createElement("li",{className:"nav-item"},n.a.createElement(u.c,{to:"/",activeClassName:"active"},"Inicio")),n.a.createElement("li",{className:"nav-item"},n.a.createElement(u.c,{to:"/servicios",activeClassName:"active"},"Servicios")),n.a.createElement("li",{className:"nav-item"},n.a.createElement(u.c,{to:"/tienda/"+this.state.userId,activeClassName:"active"},"Tienda")),n.a.createElement("li",{className:"nav-item"},n.a.createElement(u.c,{to:"/citas",activeClassName:"active"},"Citas"))),n.a.createElement("div",{className:"dropdown-divider "}),n.a.createElement("ul",{className:"navbar-nav navbar-right"},!1===this.state.identity||null===this.state.identity?n.a.createElement(n.a.Fragment,null,n.a.createElement("li",{className:"nav-item"},n.a.createElement(u.c,{to:"/register",activeClassName:"active"},"Registro")),n.a.createElement("li",{className:"nav-item"},n.a.createElement(u.c,{to:"/login",activeClassName:"active"},"Iniciar sesion"))):n.a.createElement(n.a.Fragment,null,n.a.createElement("li",{className:"nav-item dropdown"},n.a.createElement("p",{className:"nav-link dropdown-toggle",id:"navbarDropdown",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},this.state.user.nombre+" "+this.state.user.apellidos),n.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"navbarDropdown"},!1===this.state.user.admin?n.a.createElement(n.a.Fragment,null,n.a.createElement(u.b,{className:"dropdown-item",to:"/miperfil/"+this.state.userId},"Mi perfil"),n.a.createElement(u.b,{className:"dropdown-item",to:"/mispedidos/"+this.state.userId},"Mis pedidos")):n.a.createElement(n.a.Fragment,null,n.a.createElement(u.b,{className:"dropdown-item",to:"/adminperfil/"+this.state.userId},"Administracion")),n.a.createElement("div",{className:"dropdown-divider"}),n.a.createElement(u.b,{className:"dropdown-item pointer",style:{cursor:"pointer"},onClick:this.logout},"Cerrar sesion")))))))))}}]),a}(r.Component),C=(a(139),a(102)),w=a(84),S=a.n(w),R=a(85),I=a.n(R),k=a(86),O=a.n(k),j=a(87),F=a.n(j),A=function(e){Object(m.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).state={},e}return Object(o.a)(a,[{key:"render",value:function(){return n.a.createElement("div",{id:"home"},n.a.createElement("div",{id:"slider",className:" container-fluid p-0"},n.a.createElement(C.a,{showArrows:!1,showThumbs:!1,infiniteLoop:!0,autoPlay:!0,interval:6e3,transitionTime:1e3,showStatus:!1,showIndicators:!1},n.a.createElement("div",null,n.a.createElement("img",{src:S.a,alt:"carrousel1"})),n.a.createElement("div",null,n.a.createElement("img",{src:F.a,alt:"carrousel4"})),n.a.createElement("div",null,n.a.createElement("img",{src:I.a,alt:"carrousel2"})),n.a.createElement("div",null,n.a.createElement("img",{src:O.a,alt:"carrousel3"})))),n.a.createElement("div",{className:"center"},n.a.createElement("h1",{className:"titulo"},"Bienvenido a Tope Vision"),n.a.createElement("div",{id:"content"},n.a.createElement("hr",null),n.a.createElement("div",null,n.a.createElement("p",null,"Contenido de prueba"),n.a.createElement("p",null,"dvdsvdf")),n.a.createElement("div",null,n.a.createElement("p",null,"Contenido de prueba"),n.a.createElement("p",null,"dvdsvdf")))))}}]),a}(r.Component),U=function(){return n.a.createElement("footer",{id:"footer"},n.a.createElement("div",{className:"center"},n.a.createElement("p",null,"\xa9 Alvaro Torrente Perez")))},_=a(26),q=a.n(_),z=a(59),P=a.n(z),D=function(e){Object(m.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return(e=t.call.apply(t,[this].concat(s))).emailRef=n.a.createRef(),e.passwordRef=n.a.createRef(),e.url=y.url,e.state={email:null,password:null,status:null,user:{}},e.inicioGoogle=function(){var t=new P.a.auth.GoogleAuthProvider;E.signInWithPopup(t).then((function(t){var a=t.user,r=a.displayName.split(" "),n={nombre:r[0],apellidos:r[1],email:a.email,telefono:"",dni:"",imagen:"https://firebasestorage.googleapis.com/v0/b/proyecto-consulta-firebase.appspot.com/o/default-user-image.png?alt=media&token=6c3d7402-c876-48ff-b1e1-5d1a0b6cab66"};N.a.post(e.url+"user2",n).then((function(t){t.data&&e.setState({status:"success"})}))}))},e.inicioFacebook=function(){var t=new P.a.auth.FacebookAuthProvider;E.signInWithPopup(t).then((function(t){var a=t.user,r=a.displayName.split(" "),n={nombre:r[0],apellidos:r[1],email:a.email,telefono:"",dni:"",imagen:"https://firebasestorage.googleapis.com/v0/b/proyecto-consulta-firebase.appspot.com/o/default-user-image.png?alt=media&token=6c3d7402-c876-48ff-b1e1-5d1a0b6cab66"};N.a.post(e.url+"user2",n).then((function(t){t.data&&e.setState({status:"success"})}))}))},e.changeState=function(){e.setState({email:e.emailRef.current.value,password:e.passwordRef.current.value})},e.recibirFormulario=function(t){t.preventDefault(),e.changeState(),e.validator.allValid()?E.signInWithEmailAndPassword(e.state.email,e.state.password).then((function(){e.setState({password:null,status:"success"})})).catch((function(e){alert(e.message)})):(e.validator.showMessages(),e.forceUpdate(),e.setState({status:"failed"}))},e}return Object(o.a)(a,[{key:"componentWillMount",value:function(){this.validator=new q.a({messages:{required:"Este campo es obligatorio",alpha_num_space:"Solo se permiten caracteres alfanumericos",numeric:"Solo se permiten numeros",email:"Email no es correcto"}})}},{key:"render",value:function(){var e=this;return"success"===this.state.status?n.a.createElement(d.a,{to:"/logged"}):n.a.createElement("div",{id:"login",className:" col-12"},n.a.createElement("h2",{className:"text-center p-3 text-md-left"},"Iniciar sesion"),n.a.createElement("hr",null),n.a.createElement("form",{className:"col-md-5",onSubmit:this.recibirFormulario},n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"email",className:"ml-2"},"Email"),n.a.createElement("input",{className:"form-control mr-2 ml-2",type:"text",name:"email",ref:this.emailRef,onChange:this.changeState,required:!0}),this.validator.message("email",this.state.email,"required|email")),n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"password",className:"ml-2"},"Contrase\xf1a"),n.a.createElement("input",{className:"form-control mr-2 ml-2",type:"password",name:"password",ref:this.passwordRef,onChange:this.changeState,required:!0,minLength:"6"}),this.validator.message("password",this.state.password,"required")),n.a.createElement("div",{className:"clearfix"}),n.a.createElement("input",{type:"submit",value:"Iniciar sesion",className:"btn btn-success"})),n.a.createElement("div",{className:"botonessesion"},n.a.createElement("button",{className:"btngoogle row",onClick:function(){return e.inicioGoogle()}},n.a.createElement("img",{src:"https://www.gstatic.com/mobilesdk/160512_mobilesdk/auth_service_google.svg",alt:"google-boton"})," ",n.a.createElement("p",null,"Inicia sesion con Google")),n.a.createElement("button",{className:"btnfacebook row",onClick:function(){return e.inicioFacebook()}},n.a.createElement("img",{src:"https://www.gstatic.com/mobilesdk/160409_mobilesdk/images/auth_service_facebook.svg",alt:"facebook-boton"})," ",n.a.createElement("p",null,"Inicia sesion con Facebook"))))}}]),a}(r.Component),M=a(8),T=a.n(M),L=function(e){Object(m.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return(e=t.call.apply(t,[this].concat(s))).nombreRef=n.a.createRef(),e.apellidosRef=n.a.createRef(),e.emailRef=n.a.createRef(),e.passwordRef=n.a.createRef(),e.password2Ref=n.a.createRef(),e.dniRef=n.a.createRef(),e.telefonoRef=n.a.createRef(),e.url=y.url,e.state={user:{},status:null,password2:null,archivo:"default",loading:!1},e.confirmpassword=null,e.changeState=function(){e.setState({user:{nombre:e.nombreRef.current.value,apellidos:e.apellidosRef.current.value,email:e.emailRef.current.value,password:e.passwordRef.current.value,telefono:e.telefonoRef.current.value,dni:e.dniRef.current.value},password2:e.password2Ref.current.value}),e.state.password2===e.state.user.password?e.confirmpassword=!0:e.confirmpassword=!1},e.recibirFormulario=function(t){t.preventDefault(),e.changeState(),e.ejecutarFormulario()},e.recogerFoto=function(t){e.setState({archivo:t.target.files[0]})},e.ejecutarFormulario=function(){if(!0===e.confirmpassword)if(e.validator.allValid())if("default"!==e.state.archivo)e.setState({loading:!0}),v.ref(e.state.archivo.name).put(e.state.archivo).then((function(){v.ref().child(e.state.archivo.name).getDownloadURL().then((function(t){e.setState({loading:!1});var a=e.state.user;N.a.post(e.url+"user",{user:a,url:t}).then((function(t){"success"===t.data.status?(e.setState({status:"success"}),T()("Usuario registrado","Te has registrado correctamente","success")):e.setState({status:"failed"})}))}))}));else{var t=e.state.user;N.a.post(e.url+"user",{user:t,url:"https://firebasestorage.googleapis.com/v0/b/proyecto-consulta-firebase.appspot.com/o/default-user-image.png?alt=media&token=6c3d7402-c876-48ff-b1e1-5d1a0b6cab66"}).then((function(t){"success"===t.data.status?(e.setState({status:"success"}),T()("Usuario registrado","Te has registrado correctamente","success")):e.setState({status:"failed"})}))}else e.validator.showMessages(),e.forceUpdate(),e.setState({status:"failed"})},e}return Object(o.a)(a,[{key:"componentWillMount",value:function(){this.validator=new q.a({locale:"es",validators:{names_surnames:{message:"El campo debe contener letras y espacios",rule:function(e,t,a){return a.helpers.testRegex(e,/^[a-zA-Z\xc0-\xff\u00f1\u00d1]+(\s*[a-zA-Z\xc0-\xff\u00f1\u00d1]*)*[a-zA-Z\xc0-\xff\u00f1\u00d1]+$/)&&-1===t.indexOf(e)}},email2:{message:"El email no es valido",rule:function(e,t,a){return a.helpers.testRegex(e,/^(?:[^<>()[\].,;:\s@"]+(\.[^<>()[\].,;:\s@"]+)*|"[^\n"]+")@(?:[^<>()[\].,;:\s@"]+\.)+[^<>()[\]\.,;:\s@"]{2,63}$/i)&&-1===t.indexOf(e)}},telefono:{message:"El telefono no es valido",rule:function(e,t,a){return a.helpers.testRegex(e,/^[896]\d{8}$/)&&-1===t.indexOf(e)}},dni:{message:"El DNI no es valido",rule:function(e,t,a){return a.helpers.testRegex(e,/^\d{8}[a-zA-Z]$/)&&-1===t.indexOf(e)}}},messages:{required:"Este campo es obligatorio",alpha_num_space:"Solo se permiten caracteres alfanumericos",numeric:"Solo se permiten numeros",email:"Email no es correcto",alpha_space:"Solo se permiten letras y espacios"}})}},{key:"render",value:function(){var e=this;return"success"===this.state.status?n.a.createElement(d.a,{to:"/login"}):n.a.createElement("div",{id:"registro",className:" col-12"},n.a.createElement("h2",{className:"text-center p-3 text-md-left"},"Registro"),n.a.createElement("hr",null),n.a.createElement("form",{className:"col-md-5",onSubmit:this.recibirFormulario},n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"nombre",className:"ml-2"},"Nombre"),n.a.createElement("input",{id:"nombre",className:"form-control mr-2 ml-2",type:"text",name:"nombre",ref:this.nombreRef,onChange:this.changeState,required:!0}),this.validator.message("nombre",this.state.user.nombre,"required|names_surnames")),n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"apellidos",className:"ml-2"},"Apellidos"),n.a.createElement("input",{className:"form-control mr-2 ml-2",type:"text",name:"apellidos",ref:this.apellidosRef,onChange:this.changeState,required:!0}),this.validator.message("apellidos",this.state.user.apellidos,"required|names_surnames")),n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"telefono",className:"ml-2"},"Telefono"),n.a.createElement("input",{className:"form-control mr-2 ml-2",type:"text",name:"telefono",ref:this.telefonoRef,onChange:this.changeState,maxLength:"9",required:!0}),this.validator.message("telefono",this.state.user.telefono,"required|telefono")),n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"dni",className:"ml-2"},"DNI"),n.a.createElement("input",{className:"form-control mr-2 ml-2",type:"text",name:"dni",ref:this.dniRef,onChange:this.changeState,onBlur:this.changeState,required:!0}),this.validator.message("dni",this.state.user.dni,"required|dni")),n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"image",className:"ml-2"},"Avatar"),n.a.createElement("input",{className:"form-control-file mr-2 ml-2",type:"file",name:"imagen",onChange:function(t){return e.recogerFoto(t)}}),!0===this.state.loading&&n.a.createElement("small",null,"Cargando imagen...")),n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"email",className:"ml-2"},"Email"),n.a.createElement("input",{className:"form-control mr-2 ml-2",type:"text",name:"email",ref:this.emailRef,onChange:this.changeState,onBlur:this.changeState,required:!0}),this.validator.message("email",this.state.user.email,"required|email2")),n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"password",className:"ml-2"},"Contrase\xf1a"),n.a.createElement("input",{className:"form-control mr-2 ml-2",type:"password",name:"password",ref:this.passwordRef,onChange:this.changeState,onBlur:this.changeState,required:!0,minLength:"6"}),this.validator.message("password",this.state.user.password,"required")),n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"password2",className:"ml-2"},"Confirmar contrase\xf1a"),n.a.createElement("input",{className:"form-control mr-2 ml-2",type:"password",name:"password2",ref:this.password2Ref,onChange:this.changeState,onBlur:this.changeState,onKeyUp:this.changeState,required:!0,minLength:"6"}),!1===this.confirmpassword&&n.a.createElement("small",null,"La contrase\xf1a no coincide")),n.a.createElement("div",{className:"clearfix"}),n.a.createElement("input",{type:"submit",onFocus:this.changeState,onClick:this.changeState,value:"Registro",className:"btn btn-success"})))}}]),a}(r.Component),H=a(88),W=a.n(H),Y=a(176),B=a(177),V=function(e){Object(m.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).url=y.url,e.userId=null,e.productaux=[],e.loadedCarrito=!1,e.state={identity:!0,user:{},status:null,productos:[],carrito:[],categoria:"gafas",edad:"adulto",genero:"masculino",show:!1},e.onCategoriaChange=function(t){e.setState({categoria:t.target.value},e.getProductos)},e.onEdadChange=function(t){e.setState({edad:t.target.value},e.getProductos)},e.onGeneroChange=function(t){e.setState({genero:t.target.value},e.getProductos)},e.getUser=function(t){N.a.get(e.url+"getuser/"+t).then((function(t){"success"===t.data.status&&e.setState({user:t.data.user})}))},e.getCarrito=function(){N.a.get(e.url+"carrito").then((function(t){"success"===t.data.status&&(t.data.carrito?(e.setState({carrito:t.data.carrito}),e.loadedCarrito=!0):e.loadedCarrito=!1)}))},e.getProductos=function(){var t=e.state.categoria,a=e.state.edad,r=e.state.genero;N.a.post(e.url+"productos",{categoria:t,edad:a,genero:r}).then((function(t){"success"===t.data.status?e.setState({productos:t.data.productos,status:"success"}):e.setState({productos:[],status:"error"})}))},e.pulsadoEvento=function(t){e.state.productos.forEach((function(a){t===a.productId&&(e.productaux.push(a),e.setState({show:!0}))}))},e.cerradoEvento=function(){e.setState({show:!1}),e.productaux=[]},e.agregarItem=function(t){N.a.post(e.url+"carrito/agregar",{item_id:t}).then((function(t){"success"===t.data.status?(e.setState({carrito:t.data.carrito}),e.loadedCarrito=!0,e.cerradoEvento(),T()("Producto agregado correctamente","El producto se ha a\xf1adido al carrito correctamente","success")):(e.cerradoEvento(),T()("El producto no se ha agregado correctamente","Ha ocurrido un error al agregar el producto al carrito, intentelo mas tarde","error"))}))},e}return Object(o.a)(a,[{key:"componentWillMount",value:function(){var e=this;E.currentUser?(this.userId=this.props.match.params.id,"null"===this.userId?this.setState({identity:!1}):N.a.get(this.url+"getemail/"+this.userId).then((function(t){"success"===t.data.status&&t.data.email===E.currentUser.email?e.getUser(e.userId):e.setState({identity:!1})}))):this.setState({identity:!1})}},{key:"componentDidMount",value:function(){this.getProductos(),this.getCarrito()}},{key:"render",value:function(){var e,t=this;return e=this.state.productos.length>=1?this.state.productos.map((function(e,a){return n.a.createElement("div",{key:a,className:"card"},n.a.createElement("img",{className:"card-img-top",src:e.product.imagen,alt:"Cardcap"}),n.a.createElement("div",{className:"card-body pt-0 pb-0"},n.a.createElement("h4",{className:"card-title "},e.product.nombre),n.a.createElement("p",{className:"card-text h5"},e.product.precio," \u20ac"),n.a.createElement("br",null)),n.a.createElement("div",{className:"card-footer pt-2 pb-2"},n.a.createElement("button",{className:"btn btn-primary",onClick:function(){return t.pulsadoEvento(e.productId)}},"Ver producto")))})):"error"===this.state.status?n.a.createElement("h1",{className:"mt-5 text-center error"},"No hay productos para mostrar"):n.a.createElement("h1",{className:"mt-5 text-center cargando"},"Cargando..."),!1===this.state.identity?n.a.createElement(d.a,{to:"/login"}):n.a.createElement("div",{id:"tienda",className:"container-fluid mt-3"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{id:"filtros",className:"col-md-2 col-12 mt-2 "},n.a.createElement("div",{className:"form-group text-left m-2"},n.a.createElement("label",{htmlFor:"categoria"},"Categorias: "),n.a.createElement("select",{className:"form-control",name:"categoria",onChange:this.onCategoriaChange},n.a.createElement("option",{defaultValue:!0,value:"gafas"},"Gafas de sol"),n.a.createElement("option",{value:"lentillas"},"Lentillas"),n.a.createElement("option",{value:"limpieza"},"Limpieza y accesorios"))),n.a.createElement("div",{className:"genero text-left m-2"},n.a.createElement("label",{htmlFor:"genero"},"Genero: "),n.a.createElement("div",{className:"form-check"},n.a.createElement("input",{type:"radio",checked:"masculino"===this.state.genero,className:"form-check-input",name:"masculino",value:"masculino",onChange:this.onGeneroChange}),n.a.createElement("label",{className:"form-check-label",htmlFor:"masculino"},"Hombre")),n.a.createElement("div",{className:"form-check"},n.a.createElement("input",{type:"radio",className:"form-check-input",checked:"femenino"===this.state.genero,name:"femenino",value:"femenino",onChange:this.onGeneroChange}),n.a.createElement("label",{className:"form-check-label",htmlFor:"femenino"},"Mujer"))),n.a.createElement("div",{className:"edad text-left m-2"},n.a.createElement("label",{htmlFor:"edad"},"Edad: "),n.a.createElement("div",{className:"form-check"},n.a.createElement("input",{type:"radio",checked:"adulto"===this.state.edad,className:"form-check-input",name:"adulto",value:"adulto",onChange:this.onEdadChange}),n.a.createElement("label",{className:"form-check-label",htmlFor:"adulto"},"Adulto")),n.a.createElement("div",{className:"form-check"},n.a.createElement("input",{type:"radio",checked:"infantil"===this.state.edad,className:"form-check-input",name:"infantil",value:"infantil",onChange:this.onEdadChange}),n.a.createElement("label",{className:"form-check-label",htmlFor:"infantil"},"Infantil")))),n.a.createElement("div",{id:"productos",className:"col-7 ml-2 mt-2"},e),!0===this.loadedCarrito&&n.a.createElement("div",{id:"carrito-button",className:"col-md-2 col-12 align-content-center align-items-center align-self-center justify-content-center m-2 p-3"},n.a.createElement(u.b,{to:{pathname:"/carrito",state:{userId:this.userId,carrito:this.state.carrito}},className:"ircarrito btn btn-primary text-center"},n.a.createElement("div",{className:"numeroitems d-inline pr-2 pl-2 m-3 d-flex align-items-center justify-content-center align-self-center"},n.a.createElement("span",{className:"m-2"},this.state.carrito.length," "),n.a.createElement("img",{className:"m-2",src:"../"+W.a,alt:"icono-carrito"})),n.a.createElement("p",{className:"mb-2"},"Ver Carrito"))),1===this.productaux.length&&n.a.createElement(Y.a,{show:this.state.show,onHide:this.cerradoEvento,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0},n.a.createElement(Y.a.Header,{closeButton:!0},n.a.createElement(Y.a.Title,{className:"text-center"},n.a.createElement("img",{className:"img-item",src:this.productaux[0].product.imagen,alt:"iamgen-item"}),n.a.createElement("h4",null,this.productaux[0].product.nombre),n.a.createElement("p",null,n.a.createElement("small",null,"Id referencia: ",this.productaux[0].productId)),n.a.createElement("p",{className:"card-text h5"},this.productaux[0].product.precio," \u20ac"),n.a.createElement("br",null))),n.a.createElement(Y.a.Body,null,n.a.createElement("div",{className:"infocitacontacto pl-3"},n.a.createElement("p",{className:"m-1 h5 "},"Descripcion del producto:"),n.a.createElement("p",{className:"m-1 "},this.productaux[0].product.descripcion)),n.a.createElement("div",{className:"infoactualizarcita mt-3"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col d-flex justify-content-between  mt-2 mb-2"},n.a.createElement("button",{className:"btn btn-primary m-auto",onClick:function(){return t.agregarItem(t.productaux[0].productId)}},"Agregar al carrito"))))),n.a.createElement(Y.a.Footer,null,n.a.createElement(B.a,{variant:"secondary",onClick:this.cerradoEvento},"Cerrar")))))}}]),a}(r.Component),Z=function(e){Object(m.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return(e=t.call.apply(t,[this].concat(s))).nombreRef=n.a.createRef(),e.apellidosRef=n.a.createRef(),e.emailRef=n.a.createRef(),e.telefonoRef=n.a.createRef(),e.url=y.url,e.state={cita:{nombre:null,apellidos:null,email:null,telefono:null},status:null},e.changeState=function(){e.setState({cita:{nombre:e.nombreRef.current.value,apellidos:e.apellidosRef.current.value,email:e.emailRef.current.value,telefono:e.telefonoRef.current.value}})},e.recibirFormulario=function(t){if(t.preventDefault(),e.changeState(),e.validator.allValid()){var a=e.state.cita;N.a.post(e.url+"cita",a).then((function(t){"success"===t.data.status?(e.setState({status:"success"}),T()("Cita enviada","Contactaremos contigo por email","success"),N.a.post(e.url+"email/cita")):(e.setState({status:"failed"}),T()("Cita no enviada","Se ha producido un error","error"))}))}else e.validator.showMessages(),e.forceUpdate(),e.setState({status:"failed"})},e}return Object(o.a)(a,[{key:"componentWillMount",value:function(){this.validator=new q.a({locale:"es",validators:{names_surnames:{message:"El campo debe contener letras y espacios",rule:function(e,t,a){return a.helpers.testRegex(e,/^[a-zA-Z\xc0-\xff\u00f1\u00d1]+(\s*[a-zA-Z\xc0-\xff\u00f1\u00d1]*)*[a-zA-Z\xc0-\xff\u00f1\u00d1]+$/)&&-1===t.indexOf(e)}},email2:{message:"El email no es valido",rule:function(e,t,a){return a.helpers.testRegex(e,/^(?:[^<>()[\].,;:\s@"]+(\.[^<>()[\].,;:\s@"]+)*|"[^\n"]+")@(?:[^<>()[\].,;:\s@"]+\.)+[^<>()[\]\.,;:\s@"]{2,63}$/i)&&-1===t.indexOf(e)}},telefono:{message:"El telefono no es valido",rule:function(e,t,a){return a.helpers.testRegex(e,/^[896]\d{8}$/)&&-1===t.indexOf(e)}},dni:{message:"El DNI no es valido",rule:function(e,t,a){return a.helpers.testRegex(e,/^\d{8}[a-zA-Z]$/)&&-1===t.indexOf(e)}}},messages:{required:"Este campo es obligatorio",alpha_num_space:"Solo se permiten caracteres alfanumericos",numeric:"Solo se permiten numeros",email:"Email no es correcto",alpha_space:"Solo se permiten letras y espacios"}})}},{key:"render",value:function(){return n.a.createElement("div",{id:"citas",className:" col-12"},n.a.createElement("h2",{className:"text-center p-3 text-md-left"},"Pedir Cita"),n.a.createElement("hr",null),n.a.createElement("form",{className:"col-md-5",onSubmit:this.recibirFormulario},n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"nombre",className:"ml-2"},"Nombre"),n.a.createElement("input",{id:"nombre",className:"form-control mr-2 ml-2",type:"text",name:"nombre",ref:this.nombreRef,onChange:this.changeState,required:!0}),this.validator.message("nombre",this.state.cita.nombre,"required|names_surnames")),n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"apellidos",className:"ml-2"},"Apellidos"),n.a.createElement("input",{className:"form-control mr-2 ml-2",type:"text",name:"apellidos",ref:this.apellidosRef,onChange:this.changeState,required:!0}),this.validator.message("apellidos",this.state.cita.apellidos,"required|names_surnames")),n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"telefono",className:"ml-2"},"Telefono"),n.a.createElement("input",{className:"form-control mr-2 ml-2",type:"text",name:"telefono",ref:this.telefonoRef,onChange:this.changeState,maxLength:"9",required:!0}),this.validator.message("telefono",this.state.cita.telefono,"required|telefono")),n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"email",className:"ml-2"},"Email"),n.a.createElement("input",{className:"form-control mr-2 ml-2",type:"text",name:"email",ref:this.emailRef,onChange:this.changeState,required:!0}),this.validator.message("email",this.state.cita.email,"required|email2")),n.a.createElement("div",{className:"clearfix"}),"success"===this.state.status?n.a.createElement("input",{type:"submit",value:"Pedir cita",className:"btn btn-success",disabled:!0}):n.a.createElement("input",{type:"submit",value:"Pedir cita",className:"btn btn-success"})))}}]),a}(r.Component),$=function(e){Object(m.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).state={},e}return Object(o.a)(a,[{key:"render",value:function(){return n.a.createElement("h1",null,"Servicios")}}]),a}(r.Component),K=function(){return n.a.createElement("section",{id:"content",className:"mt-5"},n.a.createElement("h2",{className:"subheader"},"Pagina no encontrada"),n.a.createElement("p",null,"La pagina no existe en la web"))},G=a(29),Q=a.n(G),J=function(e){Object(m.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return(e=t.call.apply(t,[this].concat(s))).url=y.url,e.userId=null,e.admin=null,e.listHistorial=null,e.nombreRef=n.a.createRef(),e.apellidosRef=n.a.createRef(),e.dniRef=n.a.createRef(),e.telefonoRef=n.a.createRef(),e.textoHistorialRef=n.a.createRef(),e.fechaHistorialRef=n.a.createRef(),e.state={identity:!0,user:{},status:null,loading:!0,archivo:"default",loading_file:!1,eliminado:!1},e.getUser=function(t){N.a.get(e.url+"getuser/"+t).then((function(t){"success"===t.data.status&&e.setState({user:t.data.user,historial:t.data.user.historial,loading:!1})}))},e.changeState=function(){e.setState({user:{nombre:e.nombreRef.current.value,apellidos:e.apellidosRef.current.value,telefono:e.telefonoRef.current.value,dni:e.dniRef.current.value,historial:e.state.historial,imagen:e.state.user.imagen}})},e.addHistorial=function(){var t=e.state.historial,a={texto:e.textoHistorialRef.current.value,fecha:Q()(e.fechaHistorialRef.current.value).format("DD/MM/YYYY")};t.push(a),e.textoHistorialRef.current.value="",e.setState({historial:t})},e.recogerFoto=function(t){e.setState({archivo:t.target.files[0]})},e.recibirFormulario=function(t){if(t.preventDefault(),e.changeState(),e.validator.allValid())if("default"!==e.state.archivo)e.setState({loading_file:!0}),v.ref(e.state.archivo.name).put(e.state.archivo).then((function(){v.ref().child(e.state.archivo.name).getDownloadURL().then((function(t){e.setState({loading_file:!1});var a=e.state.user;N.a.put(e.url+"user",{user:a,userId:e.userId,url:t}).then((function(a){"success"===a.data.status?(e.setState({user:{nombre:e.nombreRef.current.value,apellidos:e.apellidosRef.current.value,telefono:e.telefonoRef.current.value,dni:e.dniRef.current.value,historial:e.state.historial,imagen:t},status:"success"}),T()("Usuario actualizado","Tu perfil se ha actualizado correctamente","success")):(e.setState({status:"failed"}),T()("Usuario no actualizado","Tu perfil no se ha actualizado correctamente","error"))}))}))}));else{var a=e.state.user;N.a.put(e.url+"user",{user:a,userId:e.userId,url:e.state.user.imagen}).then((function(t){"success"===t.data.status?(e.setState({user:{nombre:e.nombreRef.current.value,apellidos:e.apellidosRef.current.value,telefono:e.telefonoRef.current.value,dni:e.dniRef.current.value,historial:e.state.historial,imagen:e.state.user.imagen},status:"success"}),T()("Usuario actualizado","Tu perfil se ha actualizado correctamente","success")):(e.setState({status:"failed"}),T()("Usuario no actualizado","Tu perfil no se ha actualizado correctamente","error"))}))}else e.validator.showMessages(),e.forceUpdate(),e.setState({status:"failed"})},e.eliminarUsuario=function(){var t=e.userId;N.a.delete(e.url+"user/"+t).then((function(e){"success"===e.data.status?T()("Usuario eliminado","El usuario ha sido eliminado correctamente","success"):T()("Usuario no eliminado","Se ha producido un error al eliminar usuario","error")}))},e}return Object(o.a)(a,[{key:"componentWillMount",value:function(){var e=this;if(this.props.match.params.admin&&(this.admin=!0),this.validator=new q.a({locale:"es",validators:{names_surnames:{message:"El campo debe contener letras y espacios",rule:function(e,t,a){return a.helpers.testRegex(e,/^[a-zA-Z\xc0-\xff\u00f1\u00d1]+(\s*[a-zA-Z\xc0-\xff\u00f1\u00d1]*)*[a-zA-Z\xc0-\xff\u00f1\u00d1]+$/)&&-1===t.indexOf(e)}},email2:{message:"El email no es valido",rule:function(e,t,a){return a.helpers.testRegex(e,/^(?:[^<>()[\].,;:\s@"]+(\.[^<>()[\].,;:\s@"]+)*|"[^\n"]+")@(?:[^<>()[\].,;:\s@"]+\.)+[^<>()[\]\.,;:\s@"]{2,63}$/i)&&-1===t.indexOf(e)}},telefono:{message:"El telefono no es valido",rule:function(e,t,a){return a.helpers.testRegex(e,/^[896]\d{8}$/)&&-1===t.indexOf(e)}},dni:{message:"El DNI no es valido",rule:function(e,t,a){return a.helpers.testRegex(e,/^\d{8}[a-zA-Z]$/)&&-1===t.indexOf(e)}}},messages:{required:"Este campo es obligatorio",alpha_num_space:"Solo se permiten caracteres alfanumericos",numeric:"Solo se permiten numeros",email:"Email no es correcto",alpha_space:"Solo se permiten letras y espacios"}}),E.currentUser)if(!0===this.admin){this.userId=this.props.match.params.id;var t=E.currentUser.email;N.a.get(this.url+"user/"+t).then((function(t){"success"===t.data.status&&t.data.user.email===E.currentUser.email?e.getUser(e.userId):e.setState({identity:!1})}))}else this.userId=this.props.match.params.id,N.a.get(this.url+"getemail/"+this.userId).then((function(t){"success"===t.data.status&&t.data.email===E.currentUser.email?e.getUser(e.userId):e.setState({identity:!1})}));else this.setState({identity:!1})}},{key:"render",value:function(){var e=this;return!1===this.state.loading?n.a.createElement("div",{id:"info",className:"col-lg-12 mt-3"},!0===this.state.identity?n.a.createElement(n.a.Fragment,null,!0===this.admin?n.a.createElement(n.a.Fragment,null,n.a.createElement("h2",null,"Perfil de: ",this.state.user.nombre+" "+this.state.user.apellidos),n.a.createElement("small",null,this.state.user.email)):n.a.createElement("h2",null,"Mi perfil   -   ",this.state.user.nombre+" "+this.state.user.apellidos),n.a.createElement("hr",null),n.a.createElement("div",{className:"row"},n.a.createElement("img",{className:"user-image",src:this.state.user.imagen,alt:"user"})),n.a.createElement("div",{className:"row"},n.a.createElement("form",{className:"col-md-5 ml-4 pl-0",onSubmit:this.recibirFormulario},n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"nombre",className:"ml-2"},"Nombre"),n.a.createElement("input",{id:"nombre",className:"form-control",type:"text",value:this.state.user.nombre,name:"nombre",ref:this.nombreRef,onChange:this.changeState,required:!0}),this.validator.message("nombre",this.state.user.nombre,"required|names_surnames")),n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"apellidos",className:"ml-2"},"Apellidos"),n.a.createElement("input",{className:"form-control",type:"text",name:"apellidos",value:this.state.user.apellidos,ref:this.apellidosRef,onChange:this.changeState,required:!0}),this.validator.message("apellidos",this.state.user.apellidos,"required|names_surnames")),n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"telefono",className:"ml-2"},"Telefono"),n.a.createElement("input",{className:"form-control",type:"text",name:"telefono",value:this.state.user.telefono,ref:this.telefonoRef,onChange:this.changeState,maxLength:"9",required:!0}),this.validator.message("telefono",this.state.user.telefono,"required|telefono")),n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"dni",className:"ml-2"},"DNI"),n.a.createElement("input",{className:"form-control",type:"text",name:"dni",value:this.state.user.dni,ref:this.dniRef,onChange:this.changeState,required:!0}),this.validator.message("dni",this.state.user.dni,"required|dni")),n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"image",className:"ml-2"},"Avatar"),n.a.createElement("input",{className:"form-control-file mr-2 ml-2",type:"file",name:"imagen",onChange:function(t){return e.recogerFoto(t)}}),!0===this.state.loading_file&&n.a.createElement("small",null,"Cargando imagen...")),n.a.createElement("div",{className:"clearfix"}),n.a.createElement("input",{type:"submit",value:"Actualizar datos",className:"btn btn-success"})),!0===this.admin&&n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"col-md-6 ml-5"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-12"},n.a.createElement("label",{htmlFor:"textoHistorial"},"Agregar al historial"),n.a.createElement("input",{className:"form-control mt-1 mb-1",type:"text",name:"textoHistorial",ref:this.textoHistorialRef,required:!0}),n.a.createElement("input",{className:"form-control mt-1 mb-1",type:"date",name:"fechaHistorial",ref:this.fechaHistorialRef,required:!0}),n.a.createElement("input",{className:"btn btn-success mt-1 mb-1",type:"button",value:"A\xf1adir",onClick:this.addHistorial})),n.a.createElement("div",{className:"historial col-12 mt-4"},n.a.createElement("ul",{className:"list-group"},void 0!==this.state.historial&&null!==this.state.historial.length&&this.state.historial.length>=1?this.listHistorial=this.state.historial.map((function(e,t){return n.a.createElement("li",{className:"list-group-item",key:t},n.a.createElement("p",null,e.texto+" - "+e.fecha))})):n.a.createElement("li",{className:"list-group-item error"},n.a.createElement("h3",null,"No hay ningun historial")))),n.a.createElement("button",{className:"btn btn-danger",style:{margin:"2rem auto"},onClick:this.eliminarUsuario},"Eliminar usuario")))))):n.a.createElement(n.a.Fragment,null,!0===this.admin?n.a.createElement("div",{id:"info"},n.a.createElement("h1",{className:"mt-5"},"Problema con carga de Usuario")):n.a.createElement(d.a,{to:"/login"}))):n.a.createElement("div",{id:"info"},n.a.createElement("h1",{className:"mt-5 cargando"},"Cargando..."))}}]),a}(r.Component),X=function(e){Object(m.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).url=y.url,e.state={users:{},message:null,status:null},e}return Object(o.a)(a,[{key:"componentWillMount",value:function(){var e=this;N.a.get(this.url+"users").then((function(t){"success"===t.data.status?e.setState({users:t.data.users,status:"success"}):e.setState({status:"error",message:t.data.message})}))}},{key:"render",value:function(){if(this.state.users.length>=1){var e=this.state.users.map((function(e,t){return n.a.createElement("div",{key:t,id:e.userId,className:"card"},n.a.createElement("img",{className:"card-img-top",src:e.user.imagen,alt:"Cardcap"}),n.a.createElement("div",{className:"card-body"},n.a.createElement("h5",{className:"card-title "},e.user.nombre+" "+e.user.apellidos),n.a.createElement("small",{className:"card-text"},e.user.email),n.a.createElement("br",null)),n.a.createElement("div",{className:"card-footer"},n.a.createElement(u.b,{to:"/adminperfil/requestuser/"+e.userId,className:"btn btn-primary"},"Ver Perfil")))}));return n.a.createElement("div",{id:"clientes",className:"row"},e)}return void 0===this.state.users.length&&"error"===this.state.status?n.a.createElement("div",{id:"clientes",className:"text-center"},n.a.createElement("h1",{className:"mt-5 error"},"No hay clientes para mostrar")):n.a.createElement("div",{id:"clientes",className:"text-center"},n.a.createElement("h1",{className:"mt-5 cargando"},"Cargando..."))}}]),a}(r.Component),ee=function(e){Object(m.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).url=y.url,e.pedidoaux=[],e.state={pedidos:[],status:null},e.pulsadoEvento=function(t){e.state.pedidos.forEach((function(a,r){t===a.pedidoId&&(e.pedidoaux.push(a),e.setState({show:!0}))}))},e.cerradoEvento=function(){e.setState({show:!1}),e.pedidoaux=[]},e}return Object(o.a)(a,[{key:"componentWillMount",value:function(){var e=this;N.a.get(this.url+"pendingpedidos").then((function(t){"success"===t.data.status?e.setState({pedidos:t.data.pedidos,status:"success"}):e.setState({status:"error"})}))}},{key:"updatePedido",value:function(e,t,a){var r=this,n=a,s=this.state.pedidos[t].pedido;N.a.put(this.url+"pedido",{state:n,id:e}).then((function(e){if("success"===e.data.status){var a=r.state.pedidos;"terminado"===n||"rechazado"===n?(a.splice(t,1),r.setState({pedidos:a,status:"success"})):(a[t].pedido.estado=n,r.setState({pedidos:a,status:"success"})),T()("Pedido actualizado correctamente","Se enviara un email al usuario con nuevos datos de su pedido","success"),r.forceUpdate(),"rechazado"!==n&&"confirmado"!==n&&"enviado"!==n||N.a.post(r.url+"email/adminpedido",{pedido:s,state:n})}else T()("Pedido no se ha actualizado correctamente","Pedido no actualizado","error")}))}},{key:"render",value:function(){var e=this;if(this.state.pedidos.length>=1){var t=this.state.pedidos.map((function(t,a){return n.a.createElement("li",{className:"list-group-item ",key:a},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-3 m-1 pedido-list-item",onClick:function(){return e.pulsadoEvento(t.pedidoId)}},n.a.createElement("h5",null,t.pedido.detalles.nombre+" "+t.pedido.detalles.apellidos),n.a.createElement("p",null,t.pedido.detalles.email)),n.a.createElement("div",{className:"col-md-3 col-9 pedido-list-item",onClick:function(){return e.pulsadoEvento(t.pedidoId)}},n.a.createElement("div",{className:"row  "},n.a.createElement("div",{className:"col-5 m-1"},n.a.createElement("h6",null,"Fecha: "),n.a.createElement("p",null,t.pedido.fecha)),n.a.createElement("div",{className:"col-5 m-1"},n.a.createElement("h6",null,"Estado:"),n.a.createElement("p",null,t.pedido.estado)))),n.a.createElement("div",{className:"col-md-5 col-12 m-1"},n.a.createElement("button",{className:"btn btn-success mr-1 ml-1",onClick:function(){return e.updatePedido(t.pedidoId,a,"confirmado")}},"Confirmar"),n.a.createElement("button",{className:"btn btn-primary mr-1 ml-1",onClick:function(){return e.updatePedido(t.pedidoId,a,"enviado")}},"Enviado"),n.a.createElement("button",{className:"btn btn-secondary mr-1 ml-1",onClick:function(){return e.updatePedido(t.pedidoId,a,"terminado")}},"Terminado"),n.a.createElement("button",{className:"btn btn-danger mr-1 ml-1",onClick:function(){return e.updatePedido(t.pedidoId,a,"rechazado")}},"Rechazar"))))}));return n.a.createElement("div",{id:"clientes ",className:"text-center"},n.a.createElement("ul",{className:"list-group"},t),1===this.pedidoaux.length&&n.a.createElement(Y.a,{show:this.state.show,onHide:this.cerradoEvento,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0},n.a.createElement(Y.a.Header,{closeButton:!0},n.a.createElement(Y.a.Title,{className:"text-center"},n.a.createElement("h4",null,"ID: ",this.pedidoaux[0].pedidoId),n.a.createElement("p",null,n.a.createElement("strong",null,"Fecha: "),this.pedidoaux[0].pedido.fecha),n.a.createElement("p",null,n.a.createElement("strong",null,"Direccion de envio: "),this.pedidoaux[0].pedido.detalles.direccion+", "+this.pedidoaux[0].pedido.detalles.municipio+", "+this.pedidoaux[0].pedido.detalles.provincia+" - "+this.pedidoaux[0].pedido.detalles.cp))),n.a.createElement(Y.a.Body,null,n.a.createElement("div",{className:"infocitacontacto pl-3"},n.a.createElement("h6",{className:"m-1 "},"Telefono: ",this.pedidoaux[0].pedido.detalles.telefono),n.a.createElement("h6",{className:"m-1 "},"Email: ",this.pedidoaux[0].pedido.detalles.email),n.a.createElement("h6",{className:"m-1"},"ID usuario: ",this.pedidoaux[0].pedido.id_usuario)),n.a.createElement("div",{className:"infocarrito pl-3"},n.a.createElement("ul",null,this.pedidoaux[0].pedido.productos.map((function(e,t){return n.a.createElement("li",{key:t,className:"list-group-item m-2"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:" col-8 text-md-left text-center"},n.a.createElement("img",{src:e.imagen,className:"imagencarrito",alt:"Cartimg"}),n.a.createElement("p",{className:"d-inline  m-3"},e.nombre)),n.a.createElement("div",{className:"col-4 align-self-center"},n.a.createElement("div",{className:"row justify-content-center"},n.a.createElement("div",{className:"col mt-2"},n.a.createElement("div",{className:"row flex-nowrap align-items-center justify-content-center align-self-center"},n.a.createElement("div",{className:"col text-center p-1"},n.a.createElement("label",{className:"text-center "},"Cantidad: ",n.a.createElement("strong",null,e.cantidad)))))))))})),n.a.createElement("li",{className:"list-group-item m-2 text-right"},n.a.createElement("p",{className:"h6 mr-3"},"Total: ",this.pedidoaux[0].pedido.precio_total," \u20ac"))))),n.a.createElement(Y.a.Footer,null,n.a.createElement(B.a,{variant:"secondary",onClick:this.cerradoEvento},"Cerrar"))))}return void 0===this.state.pedidos.length||"error"===this.state.status?n.a.createElement("div",{id:"clientes",className:"text-center"},n.a.createElement("h1",{className:"mt-5 error"},"No hay pedidos para mostrar")):n.a.createElement("div",{id:"clientes",className:"text-center"},n.a.createElement("h1",{className:"mt-5 cargando"},"Cargando..."))}}]),a}(r.Component),te=function(e){Object(m.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).url=y.url,e.state={citas:[],status:null},e}return Object(o.a)(a,[{key:"componentWillMount",value:function(){var e=this;N.a.get(this.url+"pendingcitas").then((function(t){"success"===t.data.status?e.setState({citas:t.data.citas,status:"success"}):e.setState({status:"error"})}))}},{key:"updateCita",value:function(e,t,a){var r=this;e.preventDefault();var n=Q()(e.target[0].value).format("DD/MM/YYYY"),s=e.target[1].value,l=this.state.citas[a].cita;l.hora=s,l.fecha=n,l.estado="actualizado",N.a.put(this.url+"cita",{cita:l,id:t}).then((function(e){if("success"===e.data.status){var t=r.state.citas;t.splice(a,1),r.setState({citas:t,status:"success"}),T()("Cita guardada correctamente","Cita se ha guardado en tu calendario correctamente","success"),r.forceUpdate(),N.a.post(r.url+"email/confirmacita",{cita:l})}else T()("Cita no se ha guardado correctamente","Cita no se ha guardado en tu calendario","error")}))}},{key:"render",value:function(){var e=this;if(this.state.citas.length>=1){var t=this.state.citas.map((function(t,a){return n.a.createElement("li",{className:"list-group-item",key:a},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-4"},n.a.createElement("h5",null,t.cita.user.nombre+" "+t.cita.user.apellidos),n.a.createElement("p",null,t.cita.user.email)),n.a.createElement("div",{className:"col-md-8 col-12"},n.a.createElement("form",{onSubmit:function(r){return e.updateCita(r,t.citaId,a)}},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col"},n.a.createElement("input",{className:"form-control m-1",type:"date",name:"fechaCita",required:!0})),n.a.createElement("div",{className:"col"},n.a.createElement("input",{className:"form-control m-1 ",type:"time",name:"horaCita",min:"09:00",max:"20:00",required:!0})),n.a.createElement("div",{className:"col"},n.a.createElement("input",{className:"btn btn-success mr-4 ml-4",type:"submit",value:"Aceptar"})))))))}));return n.a.createElement("ul",{className:"list-group"},t)}return void 0===this.state.citas.length||"error"===this.state.status?n.a.createElement("div",{id:"clientes",className:"text-center"},n.a.createElement("h1",{className:"mt-5 error"},"No hay citas para mostrar")):n.a.createElement("div",{id:"clientes",className:"text-center"},n.a.createElement("h1",{className:"mt-5 cargando"},"Cargando..."))}}]),a}(r.Component),ae=a(63),re=(a(149),Object(ae.b)(Q.a)),ne=function(e){Object(m.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).eventsList=[],e.url=y.url,e.citaaux=[],e.state={citas:[],message:null,status:null,show:!1},e.actualizadorCitas=function(){e.eventsList=[],e.state.citas.forEach((function(t,a){var r=t.cita.fecha.split("/"),n=t.cita.hora.split(":");e.eventsList.push({title:t.cita.user.nombre+" "+t.cita.user.apellidos,start:new Date(parseInt(r[2]),parseInt(r[1])-1,parseInt(r[0]),parseInt(n[0]),parseInt(n[1]),0),end:new Date(parseInt(r[2]),parseInt(r[1])-1,parseInt(r[0]),parseInt(n[0])+1,parseInt(n[1]),0),id:t.citaId}),e.forceUpdate()}))},e.pulsadoEvento=function(t){e.state.citas.forEach((function(a,r){t.id===a.citaId&&(e.citaaux.push(a),e.setState({show:!0}))}))},e.cerradoEvento=function(){e.setState({show:!1}),e.citaaux=[]},e}return Object(o.a)(a,[{key:"componentWillMount",value:function(){var e=this;N.a.get(this.url+"updatedcitas").then((function(t){"success"===t.data.status?(e.setState({citas:t.data.citas,status:"success"}),e.actualizadorCitas(),e.forceUpdate()):e.setState({status:"error",message:t.data.message})}))}},{key:"updateCita",value:function(e,t){var a=this;e.preventDefault();var r=Q()(e.target[0].value).format("DD/MM/YYYY"),n=e.target[1].value,s=this.citaaux[0].cita;s.hora=n,s.fecha=r,s.estado="actualizado",N.a.put(this.url+"cita",{cita:s,id:t}).then((function(e){"success"===e.data.status?(a.actualizadorCitas(),a.cerradoEvento(),T()("Cita guardada correctamente","Cita se ha guardado en tu calendario correctamente","success"),a.forceUpdate(),N.a.post(a.url+"email/cambiocita",{cita:s})):T()("Cita no se ha guardado correctamente","Cita no se ha guardado en tu calendario","error")}))}},{key:"envioRecordatorio",value:function(e){var t=e;N.a.post(this.url+"email/recordatorio",{cita:t}).then((function(e){"success"===e.data.status&&T()("Recordatorio de cita enviado","Se ha enviado un correo de recordatorio al cliente","success")}))}},{key:"render",value:function(){var e=this;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"bigCalendar-container"},n.a.createElement(ae.a,{localizer:re,events:this.eventsList,startAccessor:"start",endAccessor:"end",defaultView:"week",onSelectEvent:function(t){e.pulsadoEvento(t)},min:new Date(2008,0,1,9,0),max:new Date(2008,0,1,20,0),style:{height:500,margin:"2rem"}})),1===this.citaaux.length&&n.a.createElement(Y.a,{show:this.state.show,onHide:this.cerradoEvento,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0},n.a.createElement(Y.a.Header,{closeButton:!0},n.a.createElement(Y.a.Title,{className:"text-center"},n.a.createElement("h2",null,this.citaaux[0].cita.fecha+" - "+this.citaaux[0].cita.hora),n.a.createElement("h4",null,this.citaaux[0].cita.user.nombre+" "+this.citaaux[0].cita.user.apellidos))),n.a.createElement(Y.a.Body,null,n.a.createElement("div",{className:"infocitacontacto pl-3"},n.a.createElement("h6",{className:"m-1 "},"Telefono: ",this.citaaux[0].cita.user.telefono),n.a.createElement("h6",{className:"m-1 "},"Email: ",this.citaaux[0].cita.user.email)),n.a.createElement("div",{className:"infoactualizarcita mt-3"},n.a.createElement("form",{className:"col-12",onSubmit:function(t){return e.updateCita(t,e.citaaux[0].citaId)}},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col"},n.a.createElement("input",{className:"form-control m-1",type:"date",name:"fechaCita",required:!0})),n.a.createElement("div",{className:"col"},n.a.createElement("input",{className:"form-control m-1 ",type:"time",name:"horaCita",min:"09:00",max:"20:00",required:!0})),n.a.createElement("div",{className:"col"},n.a.createElement("input",{className:"btn btn-success m-1",type:"submit",value:"Actualizar cita"})))),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col d-flex justify-content-between  mt-2 mb-2"},n.a.createElement("button",{className:"btn btn-primary m-auto",onClick:function(){return e.envioRecordatorio(e.citaaux[0].cita)}},"Enviar recordatorio"))))),n.a.createElement(Y.a.Footer,null,n.a.createElement(B.a,{variant:"secondary",onClick:this.cerradoEvento},"Cerrar"))))}}]),a}(r.Component),se=a(31),le=function(e){Object(m.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).url=y.url,e.userId=null,e.state={identity:!0,user:{},status:null,loading:!0},e.getUser=function(t){N.a.get(e.url+"getuser/"+t).then((function(t){"success"===t.data.status&&(e.setState({user:t.data.user,loading:!1}),!1===e.state.user.admin&&e.setState({identity:!1}))}))},e}return Object(o.a)(a,[{key:"componentWillMount",value:function(){var e=this;void 0===E.currentUser?this.setState({identity:!1}):(this.userId=this.props.match.params.adminid,N.a.get(this.url+"getemail/"+this.userId).then((function(t){"success"===t.data.status&&t.data.email===E.currentUser.email?e.getUser(e.userId):e.setState({identity:!1})})))}},{key:"render",value:function(){return!1===this.state.loading?n.a.createElement("div",{id:"admin",className:"col-lg-12 mt-3"},!0===this.state.identity?n.a.createElement(n.a.Fragment,null,n.a.createElement("h2",null,"Bienvenido   -   ",this.state.user.nombre+" "+this.state.user.apellidos),n.a.createElement("hr",null),n.a.createElement(u.a,null,n.a.createElement("div",{id:"panel"},n.a.createElement(d.a,{exact:!0,from:"/",to:"/adminperfil/"+this.userId+"/clientes"}),n.a.createElement(se.d,{className:"nav-tabs mt-5"},n.a.createElement(se.e,null,n.a.createElement(se.f,{to:"/adminperfil/"+this.userId+"/clientes"},"Clientes")),n.a.createElement(se.e,null,n.a.createElement(se.f,{to:"/adminperfil/"+this.userId+"/citas"},"Citas")),n.a.createElement(se.e,null,n.a.createElement(se.f,{to:"/adminperfil/"+this.userId+"/calendario"},"Calendario")),n.a.createElement(se.e,null,n.a.createElement(se.f,{to:"/adminperfil/"+this.userId+"/pedidos"},"Pedidos"))),n.a.createElement(d.d,null,n.a.createElement(d.b,{path:"/adminperfil/"+this.userId+"/clientes"},n.a.createElement(X,null)),n.a.createElement(d.b,{path:"/adminperfil/"+this.userId+"/citas"},n.a.createElement(te,null)),n.a.createElement(d.b,{path:"/adminperfil/"+this.userId+"/calendario"},n.a.createElement(ne,null)),n.a.createElement(d.b,{path:"/adminperfil/"+this.userId+"/pedidos"},n.a.createElement(ee,null)),n.a.createElement(d.b,{exact:!0,path:"/perfil/:id/:admin",component:J}),n.a.createElement(d.b,{path:"/adminperfil/requestuser/:id",render:function(e){var t=e.match.params.id;return n.a.createElement(d.a,{to:"/perfil/"+t+"/"+!0})}}))))):n.a.createElement(n.a.Fragment,null,n.a.createElement(d.a,{to:"/login"}))):n.a.createElement("h1",{className:"mt-5 cargando"},"Cargando....")}}]),a}(r.Component),ie=function(e){Object(m.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).url=y.url,e.userId=null,e.loading=!0,e.state={carrito:[],identity:!0,user:{}},e.getCarrito=function(){N.a.get(e.url+"carrito").then((function(t){"success"===t.data.status&&(e.setState({carrito:t.data.carrito}),e.loading=!1)}))},e.getUser=function(t){N.a.get(e.url+"getuser/"+t).then((function(t){"success"===t.data.status&&e.setState({user:t.data.user})}))},e.agregarItem=function(t){N.a.post(e.url+"carrito/agregar",{item_id:t}).then((function(t){"success"===t.data.status&&e.setState({carrito:t.data.carrito})}))},e.reducirItem=function(t){N.a.post(e.url+"carrito/quitar",{item_id:t}).then((function(t){"success"===t.data.status&&e.setState({carrito:t.data.carrito})}))},e.eliminarItem=function(t){N.a.post(e.url+"carrito/eliminar",{item_id:t}).then((function(t){"success"===t.data.status?(e.setState({carrito:t.data.carrito}),T()("Producto eliminado correctamente","El producto se ha eliminado del carrito correctamente","success")):T()("El producto no se ha eliminado correctamente","Ha ocurrido un error al eliminar el producto del carrito, intentelo mas tarde","error")}))},e.procesarCompra=function(){},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.getCarrito()}},{key:"componentWillMount",value:function(){var e=this;E.currentUser?(this.userId=this.props.location.state.userId,"null"===this.userId?this.setState({identity:!1}):N.a.get(this.url+"getemail/"+this.userId).then((function(t){"success"===t.data.status&&t.data.email===E.currentUser.email?e.getUser(e.userId):e.setState({identity:!1})}))):this.setState({identity:!1})}},{key:"render",value:function(){var e,t=this;return e=this.state.carrito.length>=1?this.state.carrito.map((function(e,a){return n.a.createElement("li",{key:a,className:"list-group-item m-2"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-4 col-12 text-md-left text-center"},n.a.createElement("img",{src:e.imagen,className:"imagencarrito",alt:"Cartimg"}),n.a.createElement("p",{className:"d-md-inline  m-3"},e.nombre)),n.a.createElement("div",{className:"col-md-8 col-12 align-self-center"},n.a.createElement("div",{className:"row justify-content-center"},n.a.createElement("div",{className:"col mt-2"},n.a.createElement("div",{className:"row flex-nowrap align-items-center justify-content-center align-self-center"},n.a.createElement("div",{className:"col"},n.a.createElement("button",{className:"btn btn-danger m-1",onClick:function(){return t.reducirItem(e.id)}},"-")),n.a.createElement("div",{className:"col text-center p-1",style:{backgroundColor:"#A4AAA5",border:"1px solid black",borderRadius:"4px",color:"white"}},n.a.createElement("label",{className:"text-center "}," ",e.cantidad)),n.a.createElement("div",{className:"col"},n.a.createElement("button",{className:"btn btn-success m-1",onClick:function(){return t.agregarItem(e.id)}},"+")))),n.a.createElement("div",{className:"col-xs-12 col-md-2 mt-2"},n.a.createElement("label",{className:"text-center "},"Total: ",n.a.createElement("strong",null,e.precio_total," \u20ac"))),n.a.createElement("div",{className:"col mt-2"},n.a.createElement("button",{className:"btn btn-danger mr-4 ml-4",onClick:function(){return t.eliminarItem(e.id)}},"Eliminar"))))))})):0===this.state.carrito.length&&!1===this.loading?n.a.createElement("h1",{className:"mt-5 text-center error"},"No hay productos en el carrito"):n.a.createElement("h1",{className:"mt-5 text-center cargando"},"Cargando..."),!1===this.state.identity?n.a.createElement(d.a,{to:"/login"}):n.a.createElement("div",{id:"carrito",className:"container mt-4"},n.a.createElement("div",{className:"row "},n.a.createElement("div",{className:"col-12 text-left m-4"},n.a.createElement("h2",null,"Carrito"))),n.a.createElement("div",{className:"row"},n.a.createElement("div",{id:"carrito-list",className:"col-md-8 col-12 m-2"},n.a.createElement("ul",{className:"p-3"},e)),n.a.createElement("div",{id:"boton-procesar",className:"col-12 col-md-3 align-self-center"},n.a.createElement("div",{className:"row justify-content-center"},n.a.createElement(u.b,{to:{pathname:"/compra",state:{userId:this.userId}},className:"btn btn-primary",onClick:function(){return t.procesarCompra()}},"Procesar compra")))))}}]),a}(r.Component),oe=a(100),ce=a.n(oe).a.Button.driver("react",{React:n.a,ReactDOM:l.a}),me={currency:"EUR",env:"sandbox",client:{sandbox:"AfOEViXueKQB_yf47hoYVmSNv-cCrkK12vFYKzGQOy5_6uaQwBosuCr_uYiYkVVWSzAU2EnLA2zpmmO-",production:"-- id--"},locale:"es_ES",style:{label:"pay",color:"blue",size:"medium",shape:"pill"}},ue=a(101),de=a.n(ue),pe=function(e){Object(m.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return(e=t.call.apply(t,[this].concat(s))).url=y.url,e.paypalConf=me,e.PayPalButton=ce,e.userId=null,e.loading=!0,e.errorCarrito=!1,e.pvp=0,e.nombreRef=n.a.createRef(),e.apellidosRef=n.a.createRef(),e.telefonoRef=n.a.createRef(),e.emailRef=n.a.createRef(),e.direccionRef=n.a.createRef(),e.municipioRef=n.a.createRef(),e.cpRef=n.a.createRef(),e.provinciaRef=n.a.createRef(),e.state={carrito:[],pedido:{},identity:!0,user:{},loadedUser:!1,buttons:!1,completed:!1},e.getCarrito=function(){N.a.get(e.url+"carrito").then((function(t){"success"===t.data.status&&t.data.carrito?(e.setState({carrito:t.data.carrito}),e.loading=!1):(e.loading=!1,e.errorCarrito=!0)}))},e.getUser=function(t){N.a.get(e.url+"getuser/"+t).then((function(t){"success"===t.data.status&&e.setState({user:t.data.user,loadedUser:!0})}))},e.changeState=function(){e.setState({pedido:{nombre:e.nombreRef.current.value,apellidos:e.apellidosRef.current.value,telefono:e.telefonoRef.current.value,email:e.emailRef.current.value,provincia:e.provinciaRef.current.value,municipio:e.municipioRef.current.value,cp:e.cpRef.current.value,direccion:e.direccionRef.current.value}},(function(){e.validator.allValid()?e.setState({buttons:!0}):e.setState({buttons:!1})}))},e.onToken=function(t){var a=e.pvp,r={id_usuario:e.userId,detalles:{direccion:e.state.pedido.direccion,provincia:e.state.pedido.provincia,telefono:e.state.pedido.telefono,email:e.state.pedido.email,municipio:e.state.pedido.municipio,cp:e.state.pedido.cp,nombre:e.state.pedido.nombre,apellidos:e.state.pedido.apellidos},fecha:Q()().format("DD/MM/YYYY"),precio_total:e.pvp,productos:e.state.carrito,estado:"pendiente"};N.a.post(e.url+"pedido/generar",{save_pedido:r}).then((function(r){if("success"===r.data.status){var n=r.data.pedidoId;N.a.post(e.url+"pago",{token:t,total:a}).then((function(t){"success"===t.data.status?(T()("Compra realizada correctamente","En breves confirmaremos su pedido, ID de pedido: "+n,"success"),e.setState({completed:!0})):T()("Compra no realizada","Ha ocurrido un error con el pago","error")}))}else T()("Compra no realizada","Ha ocurrido un error con su pedido","error")}))},e.payment=function(t,a){var r={transactions:[{amount:{total:e.pvp,currency:e.paypalConf.currency},description:"Compra en Tope-Vision",custom:e.state.pedido.email||""}],note_to_payer:"Contactanos para cualquier duda en opticatopevision@gmail.com"};return a.payment.create({payment:r})},e.onAuthorize=function(t,a){var r={id_usuario:e.userId,detalles:{direccion:e.state.pedido.direccion,provincia:e.state.pedido.provincia,telefono:e.state.pedido.telefono,email:e.state.pedido.email,municipio:e.state.pedido.municipio,cp:e.state.pedido.cp,nombre:e.state.pedido.nombre,apellidos:e.state.pedido.apellidos},fecha:Q()().format("DD/MM/YYYY"),precio_total:e.pvp,productos:e.state.carrito,estado:"pendiente"};N.a.post(e.url+"pedido/generar",{save_pedido:r}).then((function(t){if("success"===t.data.status){var r=t.data.pedidoId;return a.payment.execute().then((function(t){T()("Compra realizada correctamente","En breves confirmaremos su pedido, ID: "+r,"success"),e.setState({completed:!0})})).catch((function(e){T()("Compra no realizada","Ha ocurrido un error en el pago","error")}))}T()("Compra no realizada","Ha ocurrido un error con su pedido","error")}))},e.onError=function(e){T()("Pago no realizado","Intentelo mas tarde","error")},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.getCarrito()}},{key:"componentWillMount",value:function(){var e=this;E.currentUser?(this.userId=this.props.location.state.userId,"null"===this.userId?this.setState({identity:!1}):N.a.get(this.url+"getemail/"+this.userId).then((function(t){"success"===t.data.status&&t.data.email===E.currentUser.email?e.getUser(e.userId):e.setState({identity:!1})}))):this.setState({identity:!1}),this.validator=new q.a({locale:"es",validators:{names_surnames:{message:"El campo debe contener letras y espacios",rule:function(e,t,a){return a.helpers.testRegex(e,/^[a-zA-Z\xc0-\xff\u00f1\u00d1]+(\s*[a-zA-Z\xc0-\xff\u00f1\u00d1]*)*[a-zA-Z\xc0-\xff\u00f1\u00d1]+$/)&&-1===t.indexOf(e)}},email2:{message:"El email no es valido",rule:function(e,t,a){return a.helpers.testRegex(e,/^(?:[^<>()[\].,;:\s@"]+(\.[^<>()[\].,;:\s@"]+)*|"[^\n"]+")@(?:[^<>()[\].,;:\s@"]+\.)+[^<>()[\]\.,;:\s@"]{2,63}$/i)&&-1===t.indexOf(e)}},telefono:{message:"El telefono no es valido",rule:function(e,t,a){return a.helpers.testRegex(e,/^[896]\d{8}$/)&&-1===t.indexOf(e)}},dni:{message:"El DNI no es valido",rule:function(e,t,a){return a.helpers.testRegex(e,/^\d{8}[a-zA-Z]$/)&&-1===t.indexOf(e)}}},messages:{required:"Este campo es obligatorio",alpha_num_space:"Solo se permiten caracteres alfanumericos",numeric:"Solo se permiten numeros",email:"Email no es correcto",alpha_space:"Solo se permiten letras y espacios"}})}},{key:"render",value:function(){var e,t=this;return!1===this.state.identity?n.a.createElement(d.a,{to:"/login"}):!0===this.state.completed?n.a.createElement("div",{id:"compra",className:"container-fluid mt-4"},n.a.createElement("h1",{className:"cargando"},"Gracias por confiar en Optica Tope Vision"),n.a.createElement("p",null,"En breve nos pondremos en contacto con usted"),n.a.createElement(u.b,{to:"/",className:"btn btn-success"},"Volver a Inicio")):(this.pvp=0,e=this.state.carrito.length>=1?this.state.carrito.map((function(e,a){return t.pvp=t.pvp+e.precio_total,n.a.createElement("li",{key:a,className:"list-group-item m-2"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:" col-8 text-md-left text-center"},n.a.createElement("img",{src:e.imagen,className:"imagencarrito",alt:"Cartimg"}),n.a.createElement("p",{className:"d-inline  m-3"},e.nombre)),n.a.createElement("div",{className:"col-4 align-self-center"},n.a.createElement("div",{className:"row justify-content-center"},n.a.createElement("div",{className:"col mt-2"},n.a.createElement("div",{className:"row flex-nowrap align-items-center justify-content-center align-self-center"},n.a.createElement("div",{className:"col text-center p-1"},n.a.createElement("label",{className:"text-center "},"Cantidad: ",n.a.createElement("strong",null,e.cantidad))),n.a.createElement("div",{className:"col text-center p-1"},n.a.createElement("label",{className:"text-center "},"Total: ",n.a.createElement("strong",null,e.precio_total," \u20ac")))))))))})):!0===this.errorCarrito&&!1===this.loading?n.a.createElement("h1",{className:"mt-5 text-center error"},"Error al procesar compra"):n.a.createElement("h1",{className:"mt-5 text-center cargando"},"Cargando..."),!0===this.state.loadedUser?n.a.createElement("div",{id:"compra",className:"container-fluid mt-4"},n.a.createElement("div",{className:"row "},n.a.createElement("div",{className:"col-12 text-left m-4"},n.a.createElement("h2",null,"Procesando compra"))),n.a.createElement("div",{className:"row"},n.a.createElement("div",{id:"direciones",className:"col-md-6 col-12"},n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"nombre",className:"ml-2"},"Nombre"),n.a.createElement("input",{id:"nombre",className:"form-control mr-2 ml-2",type:"text",value:this.state.user.nombre,name:"nombre",ref:this.nombreRef,onKeyUp:this.changeState,required:!0}),this.validator.message("nombre",this.state.user.nombre,"required|names_surnames")),n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"apellidos",className:"ml-2"},"Apellidos"),n.a.createElement("input",{className:"form-control mr-2 ml-2",type:"text",name:"apellidos",value:this.state.user.apellidos,ref:this.apellidosRef,onKeyUp:this.changeState,required:!0}),this.validator.message("apellidos",this.state.user.apellidos,"required|names_surnames")),n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"telefono",className:"ml-2"},"Telefono"),n.a.createElement("input",{className:"form-control mr-2 ml-2",type:"text",name:"telefono",value:this.state.user.telefono,ref:this.telefonoRef,onKeyUp:this.changeState,maxLength:"9",required:!0}),this.validator.message("telefono",this.state.user.telefono,"required|telefono")),n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"email",className:"ml-2"},"Email"),n.a.createElement("input",{className:"form-control mr-2 ml-2",type:"text",name:"email",ref:this.emailRef,value:this.state.user.email,onKeyUp:this.changeState,required:!0}),this.validator.message("email",this.state.user.email,"required|email")),n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"provincia",className:"ml-2"},"Provincia"),n.a.createElement("input",{className:"form-control mr-2 ml-2",type:"text",name:"provincia",ref:this.provinciaRef,onKeyUp:this.changeState,required:!0}),this.validator.message("provincia",this.state.pedido.provincia,"required|names_surnames")),n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"municipio",className:"ml-2"},"Municipio"),n.a.createElement("input",{className:"form-control mr-2 ml-2",type:"text",name:"municipio",ref:this.municipioRef,onKeyUp:this.changeState,required:!0}),this.validator.message("municipio",this.state.pedido.municipio,"required|names_surnames")),n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"cp",className:"ml-2"},"CP"),n.a.createElement("input",{className:"form-control mr-2 ml-2",type:"text",name:"cp",ref:this.cpRef,onKeyUp:this.changeState,required:!0,maxLength:"5",minLength:"5"}),this.validator.message("cp",this.state.pedido.cp,"required|numeric")),n.a.createElement("div",{className:"form-group text-left"},n.a.createElement("label",{htmlFor:"direccion",className:"ml-2"},"Direccion"),n.a.createElement("input",{className:"form-control mr-2 ml-2",type:"text",name:"direccion",ref:this.direccionRef,onKeyUp:this.changeState,required:!0}),this.validator.message("direccion",this.state.pedido.direccion,"required"))),n.a.createElement("div",{className:"col-md-6 col-12"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{id:"buy-list",className:"col-12 ml-3"},n.a.createElement("ul",{className:"p-3"},e,n.a.createElement("li",{className:"list-group-item m-2 text-right"},n.a.createElement("p",{className:"h6 mr-3"},"Total a pagar: ",this.pvp," \u20ac"))))),n.a.createElement("div",{className:"row"},n.a.createElement("div",{id:"pagos",className:"col-12 ml-3"},!0===this.state.buttons?n.a.createElement(n.a.Fragment,null,n.a.createElement(de.a,{ComponentClass:"boton-pago",locale:"es",currency:"EUR",stripeKey:"pk_test_xQbGMr8UIbCrgGFLNQ2l5LbI00SVNQjKoV",token:this.onToken,amount:100*this.pvp},n.a.createElement("button",{className:"boton-pago btn btn-stripe"},"Pagar con Tarjeta ",n.a.createElement("img",{className:"img-stripe",alt:"img-stripe",src:"https://upload.wikimedia.org/wikipedia/commons/thumb/b/ba/Stripe_Logo%2C_revised_2016.svg/1280px-Stripe_Logo%2C_revised_2016.svg.png"})," ")),n.a.createElement(this.PayPalButton,{env:this.paypalConf.env,client:this.paypalConf.client,payment:function(e,a){return t.payment(e,a)},onAuthorize:function(e,a){return t.onAuthorize(e,a)},onError:function(e){return t.onError(e)},style:this.paypalConf.style,commit:!0,locale:this.paypalConf.locale})):n.a.createElement("h3",{className:"error"},"Rellena los datos para habilitar pago")))))):n.a.createElement("h1",{className:"mt-5 cargando"},"Cargando..."))}}]),a}(r.Component),he=function(e){Object(m.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).userId=null,e.url=y.url,e.pedidoaux=[],e.state={identity:!1,user:{},status:null,loading:!0,pedidos:[],errorPedidos:!1,show:!1},e.getUser=function(t){N.a.get(e.url+"getuser/"+t).then((function(t){"success"===t.data.status&&(e.setState({user:t.data.user,identity:!0}),e.getPedidos())}))},e.getPedidos=function(){N.a.get(e.url+"pedidos/"+e.userId).then((function(t){"success"===t.data.status?e.setState({pedidos:t.data.pedidos,loading:!1}):e.setState({loading:!1,errorPedidos:!0})}))},e.pulsadoEvento=function(t){e.state.pedidos.forEach((function(a,r){t===a.pedidoId&&(e.pedidoaux.push(a),e.setState({show:!0}))}))},e.cerradoEvento=function(){e.setState({show:!1}),e.pedidoaux=[]},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;E.currentUser?(this.userId=this.props.match.params.id,N.a.get(this.url+"getemail/"+this.userId).then((function(t){"success"===t.data.status&&t.data.email===E.currentUser.email?e.getUser(e.userId):e.setState({identity:!1})}))):this.setState({identity:!1})}},{key:"render",value:function(){var e,t=this;return this.pvp=0,e=this.state.pedidos.length>=1?this.state.pedidos.map((function(e,a){return n.a.createElement("li",{key:a,className:"list-group-item m-2"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-4 col-12 mt-2 mb-2 text-md-left text-center"},n.a.createElement("p",{className:"h6"},"Fecha"),n.a.createElement("p",null,e.pedido.fecha)),n.a.createElement("div",{className:"col-md-4 col-12 mt-2 mb-2 estados-pedidos"},n.a.createElement("div",{className:"row justify-content-center"},n.a.createElement("div",{className:" col-4 "},n.a.createElement("p",{className:"h6"},"PVP"),n.a.createElement("p",null,e.pedido.precio_total,"\u20ac")),n.a.createElement("div",{className:" col-4"},n.a.createElement("p",{className:"h6"},"Estado"),n.a.createElement("p",null,e.pedido.estado)))),n.a.createElement("div",{className:" col-md-4 col-12 mt-2 mb-2  text-center"},n.a.createElement("button",{className:"btn btn-success",onClick:function(){return t.pulsadoEvento(e.pedidoId)}},"Detalle"))))})):!0===this.state.errorPedidos&&!1===this.state.loading?n.a.createElement("h1",{className:"mt-5 text-center error"},"No hay pedidos"):n.a.createElement("h1",{className:"mt-5 text-center cargando"},"Cargando..."),!0===this.state.identity&&!1===this.state.loading?n.a.createElement("div",{className:"col-12"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{id:"pedidos-list",className:"col-12 ml-3"},n.a.createElement("h1",{className:"m-2 text-md-left text-center"},"Mis pedidos"),n.a.createElement("ul",{className:"p-3"},e))),1===this.pedidoaux.length&&n.a.createElement(Y.a,{show:this.state.show,onHide:this.cerradoEvento,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0},n.a.createElement(Y.a.Header,{closeButton:!0},n.a.createElement(Y.a.Title,{className:"text-center"},n.a.createElement("h4",null,"ID: ",this.pedidoaux[0].pedidoId),n.a.createElement("p",null,n.a.createElement("strong",null,"Fecha: "),this.pedidoaux[0].pedido.fecha),n.a.createElement("p",null,n.a.createElement("strong",null,"Direccion de envio: "),this.pedidoaux[0].pedido.detalles.direccion+", "+this.pedidoaux[0].pedido.detalles.municipio+", "+this.pedidoaux[0].pedido.detalles.provincia+" - "+this.pedidoaux[0].pedido.detalles.cp))),n.a.createElement(Y.a.Body,null,n.a.createElement("div",{className:"infocarrito pl-3"},n.a.createElement("ul",null,this.pedidoaux[0].pedido.productos.map((function(e,t){return n.a.createElement("li",{key:t,className:"list-group-item m-2"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:" col-8 text-md-left text-center"},n.a.createElement("img",{src:e.imagen,className:"imagencarrito",alt:"Cartimg"}),n.a.createElement("p",{className:"d-inline  m-3"},e.nombre)),n.a.createElement("div",{className:"col-4 align-self-center"},n.a.createElement("div",{className:"row justify-content-center"},n.a.createElement("div",{className:"col mt-2"},n.a.createElement("div",{className:"row flex-nowrap align-items-center justify-content-center align-self-center"},n.a.createElement("div",{className:"col text-center p-1"},n.a.createElement("label",{className:"text-center "},"Cantidad: ",n.a.createElement("strong",null,e.cantidad)))))))))})),n.a.createElement("li",{className:"list-group-item m-2 text-right"},n.a.createElement("p",{className:"h6 mr-3"},"Total: ",this.pedidoaux[0].pedido.precio_total," \u20ac"))))),n.a.createElement(Y.a.Footer,null,n.a.createElement(B.a,{variant:"secondary",onClick:this.cerradoEvento},"Cerrar")))):n.a.createElement("h1",{className:"cargando"},"Cargando...")}}]),a}(r.Component),fe=function(e){Object(m.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).state={isLogged:!1},e.logged=function(){e.setState({isLogged:!0})},e.signout=function(){e.setState({isLogged:!1})},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this;return n.a.createElement(u.a,null,!0===this.state.isLogged?n.a.createElement(x,{logged:!0}):n.a.createElement(x,null),n.a.createElement(d.d,null,n.a.createElement(d.b,{exact:!0,path:"/",component:A}),n.a.createElement(d.b,{exact:!0,path:"/home",component:A}),n.a.createElement(d.b,{exact:!0,path:"/login",component:D}),n.a.createElement(d.b,{exact:!0,path:"/register",component:L}),n.a.createElement(d.b,{exact:!0,path:"/servicios",component:$}),n.a.createElement(d.b,{exact:!0,path:"/compra",component:pe}),n.a.createElement(d.b,{exact:!0,path:"/tienda/:id?",component:V}),n.a.createElement(d.b,{exact:!0,path:"/carrito",component:ie}),n.a.createElement(d.b,{exact:!0,path:"/miperfil/:id",component:J}),n.a.createElement(d.b,{exact:!0,path:"/mispedidos/:id",component:he}),n.a.createElement(d.b,{exact:!0,path:"/adminperfil/:adminid",component:le}),n.a.createElement(d.b,{exact:!0,path:"/citas",component:Z}),n.a.createElement(d.b,{exact:!0,path:"/logged",render:function(){return e.logged(),n.a.createElement(d.a,{to:"/"})}}),n.a.createElement(d.b,{exact:!0,path:"/signout",render:function(){return e.signout(),n.a.createElement(d.a,{to:"/"})}}),n.a.createElement(d.b,{component:K})),n.a.createElement(U,null))}}]),a}(r.Component);var ge=function(){return n.a.createElement("div",{className:"App"},n.a.createElement(fe,null))},Ee=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ve(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}l.a.render(n.a.createElement(ge,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat(".","/service-worker.js");Ee?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var r=a.headers.get("content-type");404===a.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):ve(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):ve(t,e)}))}}()},82:function(e,t,a){e.exports=a.p+"static/media/logo.dbc517cd.png"},84:function(e,t,a){e.exports=a.p+"static/media/a.83bde698.png"},85:function(e,t,a){e.exports=a.p+"static/media/b.8ba9f6ff.png"},86:function(e,t,a){e.exports=a.p+"static/media/c.98aafa73.png"},87:function(e,t,a){e.exports=a.p+"static/media/d.464a4d00.png"},88:function(e,t,a){e.exports=a.p+"static/media/carrito.420ed8ab.svg"}},[[105,1,2]]]);
//# sourceMappingURL=main.0d517edd.chunk.js.map